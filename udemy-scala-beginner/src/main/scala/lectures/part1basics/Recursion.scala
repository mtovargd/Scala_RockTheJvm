package lectures.part1basics

import scala.annotation.tailrec

object Recursion extends App {

  def factorialNumber(n: Int): Int = {
    if (n <= 0) 1
    else {
      println("Computing factorial of " + n + " - I first need the factorial of " + (n-1))
      val result = factorialNumber(n - 1) * n
      println("Computed factorial of " + n)

      result
    }
  }

  println(factorialNumber(10))

  def anotherFactorial(n: Int): BigInt = {
    @tailrec
    def factorialHelper(x: Int, accumulator: BigInt): BigInt =
      if (x <= 1) accumulator
      else factorialHelper(x - 1, x * accumulator) // TAIL RECURSION: use recursive call as the LAST expression

    factorialHelper(n, 1)
  }

  /*
  * another factorial of 10
  * anotherFactorial(10) = factorialHelper(10, 1)  // 10 is not less than 1 so it goes to the else branch
  * = factorialHelper(9, 10 * 1)     // 9 is not less than 1, else branch
  * = factorialHelper(8, 9 * 10 * 1)     // 8 is not less than 1, else branch
  * = factorialHelper(7, 8 * 9 * 10 * 1)       // 7 is not less than 1, else branch
  * .
  * .
  * .
  * = factorialHelper(2, 3 * 4 * ... * 10 * 1)
  * = factorialHelper(1, 2 * 3 * 4 ... * 10 * 1)
  * = accumulator     // at this point, the accumulator is 2 * 3 4 * ... * 10 * 1
  * */
  println(anotherFactorial(5000))
  // 422857792660554352220106420023358440539078667462664674884978240218135805270810820069089904787170638753708474665730068544587848606668381273633
  // 721089377278763127939036305846216064390447898698223987192970889621161265296832177550039924219683703146907264472878789790404754884162215226671
  // 9284109692369104495659717363529484002238403811206448202308576711045023061748947554283097617817240408053248099278093287840554861993645482912118
  // 7625824880218917397790005021321259804363924462646077051135884659510867547058583392465522558903547443598834738317898803463300845863151020909150
  // 9935653820010933047965742556741930917055172805200236075085991197635228755907902043369743123506916831211924495971556267407521462198986233088625
  // 9983028598648575787494459631152869708867100462684236481789899054546908613916132183441741488071862344481148312094903611965468727677556178868287
  // 20269104814092456410341835975604276458161513178575901661071782544156980883359372729995603371371200471049437656291142488605335299499642300699972
  // 204918120100819059439140675053265004775533850899097945101551091486907004407119572336026243368132330218709287699196806656569752790422258267841561
  // 0833764257810326292026872110702746813943511286015023261906499591718973641763784364912197091098409445148953589591038041769419566578348220717491055
  // 1275263914838117205260482696516264271009491939333266103010436053045911701455720958471435372194824668679346737590487226813341020786090365710880637
  // 6616249749507413107077401682180585945526445171409277469230062697511346044174567946735828782261629584248675157379172942724178783105429858245117575
  // 5118845065744248275746608002385883784923962473687615070157677258983211286322955370449025163879251275908417917446404669135310473479844649961545955
  // 4201399631735747630174003679619291994219076289544565626176704179953816113338731282351153415258130908791588363835166479722591294427065355714251173
  // 7323807232632958121797916679692329687096923901003255574789055099807487061047230646195984955239657612208673866514171699307557691897902675157342075
  // 8647963453384468350859654907273263219105040642897130962245051620646694680988699171221274045040206849232662417601329102278666872703052847094525268
  // 2549661777249964520669983692591069089408263740104349837159112645582228060636139411534431677176993435366428492829443641476961588199366138825557748
  // 7709937004594753907845149034434521174560594039916268444697661821387470705325559577933196460996662145377564935474169708562389214773222865507182490
  // 4300161861421927604523076706211429617672747041236161072200097437586474927536651495321647808490751463300710166913134206628825626182838658369836321
  // 0876071042751607334834778841479673242708041086076184128188830711509898213533840661065214708704687476099542747367350945155359976904036735338555105
  // 2571682650317682405743993414862392331981432579182193321898940450865013610998098383993110996355981328001049731588596312131853801205046787642910669
  // 3656004373056334319848790489985247012933007893445328681566797628804955328463860201334802652798369463933849956750499937078147465615434389304313842
  // 3787898184780288600997108869563298834771186312238278596365311513237793137364739742936941149902875197222799954518261548829895115192668211245135531
  // 8472209990435355949887299922035062039816011086376236539782172380237846650673624510635034423187315338308212043804710999419227821039747552717416043
  // 8901697239613055493718448361198035658960620250090936643993601720073836133544050943290724765189095025077246758419894122246593921631163520381473624
  // 7952853973208930953342191063570280557662972015655651076778080593345363112182956179288767300280245093212277885296841820826177847695564498038569127
  // 5787372678040959158711733971103165232678060798127609246173504120182666874262805385275843979167609007743380748420751185119102921960339376280986753
  // 6650852128692553215367879325218825741018661370543289737358627253701785588066398513503869440396049282588201804191780736496938858025977583988920143
  // 89747165465973510852605706234402069637065660129535734043582961473427275805630839510667375349259659518575646939723218275780003250593895303820539697
  // 5588705115430739208274224405162997087395997684612062466290981123680125798912848025050940289169597650793954371913113793144274051355996303756422145
  // 2729434179724618759796407423914783899354156583471615685849903677305661135383336708754890041309198167633074904151033759730724688583924694171554829
  // 5730750618505881581959528992660225626903439573313450666972952115230668696227920947779974336574472673471408928071411283888082693377378077293104110
  // 7675136394762006108580405960196390580157610023374638693522283858014349571781255814458629300424794040657368598620079146045902554139299500880447103
  // 84758990326548097338166940500085452723713571394902463820308668541802838317527668064278489561005755859991718966786449154063570014497194249878920859
  // 7312542755675145752063991181507363974831024907938417256534218942767691165981534300846370877695102954151365517346750540152397060425717460010899684
  // 40498845985477977905031632568489156557231006499726498721480800181770357701502983008879487243887718884416833034708723239505377642232944095773219137
  // 58237167392470421672300225688313577923039468890066246618253265849072440676702493957969721746748556299818314966561174399768048209416625746387966030
  // 51712749251192263676153375243816562173307716501295209887548564671318626023876199643348679615144083289020610828331808912213258536828564699160079521
  // 051669604516954306142123057430068772174071554732179575770175959676405638127291538675136987123955705423509992286059754699621861955313541321391264366
  // 769004654299968116805507378667706659880270629725020018828458861453443687714553613044144656133690928627482769819468364805509529686817587148599729730
  // 823329240947770852752799233048927196333147515633111927461503892192906167806079013834511370663006843762671998855151436812661373199121032354697867564
  // 212106248990055535640229243458312642310383634167817199083541404117177401859506066741983481433454442471914368282256543800478603905759224170718026706
  // 468754542116269587467953985407844646541403817511499652736211235408801669902801490332251394608326681709307138688265499773742861277894177847526813283
  // 71818759103642140881783220739808059714203285309721443041845459183002833408705783138284973283761286182927136745161897366207237396132790944984014154
  // 408304074405393067540767126182547597130843470311389815695365971788564022750674237400323621850094765267521941901241387478279883426470873616812485
  // 384444012772521050072279315853096279121131160167772077952572613800240684421885453537121341902236379684012385255288607189967725694227433323948595
  // 07557083906187745015965218441499815547610754800805419231843694819173263143060354839979078330726763672909098077282735585434803226006747253709778
  // 546456776118180736742436739176986375807214585979148503370059299496379336910028344455808983805401763540373713301931129308095828761210738037480066
  // 026976784288835826573748655678586882201514304624965599576037976868531819236580646919958407184549360692216977613754266223965864498977092147813470
  // 9127917460871630220821981434654245065731262683089579031012893360788644107230184805400373136014216229159146992019884148290014414312800903102107833
  // 305090238435726779416177246873411503598700003151092815700331081727415624680432977205070450456683898626301702989301145364477416856732512330376477
  // 8817490360525726055206843706161165397551325413693038677832672082273236642492064323630892687688266509396918616832717397574795529932424061869924203
  // 6378192948536809803525633109244821526927621911625914588639367703465348036788712613336711696822645091499705544852125975187008472002567465875240393
  // 2061045903070039438252019383102480929019684602472171298321628237994627125366359971898374425099120673688383738299653892030662843074547559074235345
  // 2740292116060913463276847495220460104095756073481551016772031875800892244947529220310938416615888235849939317451499143955573576415841854798317024
  // 2852396545108752542546477729459523036094641654199779794713680634491599877240917644313737117854221074057212116686869215324049008038420592119262287
  // 5440898261478908123698956367080804687628524499897440855677969456909042340530355943524640751677873953113928698614347227572144946891896093294375476
  // 7412349077927543383494123230600787676100899491561269340389211483702171933876178233703589258171128695634500013676198971454009866434619221976769759
  // 300105552251989130021230217808319343308804465929545521659118559392025797811229520653573629144784049464745650031154980720565803606673808895727464
  // 6437542805581932229930508928780687453740132710027442831792535500345153669317211208822760394280978864572730697997128564957693435400403072844058174
  // 6648376658498039958964243370183454151720285337810904113124462432903353964296651109482836884580127588701293156099225044518125460113274986014470437
  // 7573138810013192761246761166148335289355575031060184497889943782746138546517082416131676814639118700008128451443414067399854300727723037581116135
  // 110943556148963239297508463831529302635825353617848375585196669499722519355159538072078386151421302844500517952397609684331982925989216232235823
  // 963902625488568558754581983715590084478600867459457091181287932282220517675093718661100131936258452234939498295111992808378605235064127693375481
  // 3060959426446342507760114733420913912854162818317226214378306296240814939199718752810636734887667848160234274323002715819240418768654582651936199
  // 0687336892886715133840245486110982482004482721799496658712257174429044916781194824165631560303473833317665121218052780795958220298330611945164019
  // 4133155503796629802153576807311245305859159697099739880557435500832790718449597523535946443547896803721263445094230702539951028644582374546777610
  // 1355691621230975228615205321399874567303412767650336963668230666555205156249113252892615586386850310084918092050768065826591527616371992869425835
  // 060485973227394928608026064062752134100780181510562378792621203942478183343943387720639580111580908419079432019517823574019054659599028961771177
  // 6195270354051193727229722248442080440098750369411277686593022133010625031862085145076421052980508837197986052557750303949606158442838846866137510
  // 9684415673098380793943495700130292651779571206255558519513135740298975892834755253344098589114006944493084328740050155543325877938950802411285387
  // 5872594513640083832494447134643682614819540600411484587023407292669774063132587863479066769826618150125611769227571529124916482170237288441635760
  // 0996851100939411444677628186007072278522314941048564396255796808221289935799262208553889221164765220850367706476491496133789353761537391569177822
  // 23774483761412025334262250800730051347342277142733310634597180324024422695045809053932668910361938199883884403623179528243549536248967073415594806
  // 7688515321073064476077859628627852283657244564306449096277517172656954238392941958409527253281659572534531428389629894005886539486824117113929627
  // 35693897348293585465027868943701479838382600205820885351707321628872521452220526596961496214788484012900450773725242460507433966081818296029601919
  // 63141249985384220176951103613805617010163577435425311486693699941309409083682200719364351119785927824934914770521872265461091995972694391524004679
  // 0117360252103005188608033708484011481024635128826398617008180488838075020352144834874084915471871447885780957451549950500507078942884288841002787
  // 77774559811323199406241765321486863165817367744100840634369599895192883108691245178663425593534582425894113905164694403775626658215778459368299096
  // 797545483505104736337708391510338546396027534864016352046338843423467149356414291608568467248742447820551137591682364722977936129710803025309344
  // 7811552773754045896899035480805830938126732359356309854656437620938537105280834460718907600338878161801985327375949856691670470344843836350341636
  // 8325266403224174519476678140428319327482851882140344319384445475456765253419659194332132585432270070759038565239668227171300009189122050845185261
  // 5146279377175975288529786379317112125295294433237579100729090017035587637986124802814630939443919169501293363150452851635393128685864274372961094
  // 4610123560487743986329961189975596599660874904927116768526867533599129758320908955329640952364011606007849500537789278375014734412212377790772713
  // 4146647404489837589487675423294546899354220341669961366698976529978580795899055864050388507083137333076839766882463680992355219727241831735127646
  // 18911238048588311556947788810175970897768214964434031792444308517030369221413762119438864198950836033930645903736184293702871075832196660754611376
  // 107636254392861431624289075402108223362001230938473731222037426903383857992867857293943416828705376337409193818463226113174093427811791889164244
  // 751354347844604054945537983455616335381586844169205451869891943417538666390033575676560326436376790672162662033087842554515720811724638125151266
  // 9846685887209013144861632560461019513371814585249988176629925142145014710206193190373671380347663431029705222414785030188275106347446241258707937
  // 3390850957577243167350668850942087615361644404437558601606258370913005741620652736709418886679645705507447247141370019681652159543806985159994833
  // 613575213221061318847719266419423953514122335467464614917430134758660373381765326045574029254722793602889261893858996956568767830171868739887638
  // 8762597274397606281326344664767941367972618493339507466582044167798980660420393711666633669628256934909734839115586900485603251221924153426852236
  // 9316036765491047702733521540143168338872968405443296967684036073182435336224865433823598123544167514608340781166661858781733980624199254577853462
  // 6780390399375578027599429572052810437756669793968381093411189594757662201912175350936389854652830786923706625123236843902355876362283246571611837
  // 1407880766116217951788797280184157201963908440026903745038119279717031448987181503131999211156390830301728801261064206200535924027827739391802639
  // 1717720136125984776933980647063763022608885359937595079088789081791802195768033381968605120487107610874898411568740159953020639098138993261095538
  // 8682640840121608310405259745392515764037328890867369483664047346227085600408916107822219434051797945501553476829668553200975019055814199145911241
  // 8150106225562741123157137735869719437413082202738384381594063857138791333759236233044045348723304724066878413333304789899525522146884797381356808
  // 399564453300522255132015526776889541277032927867082749004117207666311278363815234354768166312118908686499138023628177527594606121181334205479180
  // 161922034691276038190052801234397359827046149981451132461819565852823204465827008206493468025155651127282208381156319225650994520122266660322605
  // 939624701970766858039628697555111518997304908505175876530678575800066042406689417062030384678586025737063435259958688508867965400446518779020894
  // 293515321731675011373803146603464242948907632222813376329991964133650202862728926808756003661377060746357551507908798209972266013047290782574690
  // 817545195240557379131311317061732319159867397158837310816891696865770415069551294765238613481576696758036476200528906022274453174430549840286304
  // 885086955776152865032608094116068857069889476204647850088430397310741277419196169745051711032908281520127388866342263149214709022001694063650481
  // 204703601673860229067162981641119820226860796132473955005756756456820475461904042301106237136739599567894088470597685951450501724151774601735143
  // 099097261550937833472000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  // 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  // 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  // 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  // 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  // 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  // 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  // 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  // 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000


  @tailrec
  def concatenateTailRec(aString: String, n: Int, accumulator: String): String =
    if (n <= 0) accumulator
    else concatenateTailRec(aString, n-1, aString + accumulator)
  println(concatenateTailRec("hi", 3, ""))

  def isPrime(n: Int): Boolean = {
    @tailrec
    def isPrimeTailRec(t: Int, isStillPrime: Boolean): Boolean = {
      if (!isStillPrime) false
      if (t <= 1) true
      else isPrimeTailRec(t - 1, n % t != 0 && isStillPrime)
    }
    isPrimeTailRec(n / 2, true)
  }

  println(isPrime(2003 * 6))

  def fibonacciNumber(n: Int): Int = {
    @tailrec
    def fiboTailRec(i: Int, last: Int, nextToLast: Int): Int =
      if (i >= n) last
      else fiboTailRec(i + 1, last + nextToLast, last)

    if(n <= 2) 1
    else fiboTailRec(2, 1, 1)
  }

  println(fibonacciNumber(8))

}
